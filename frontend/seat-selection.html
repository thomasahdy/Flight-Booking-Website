<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Your Seat - Tripma</title>
    <link rel="stylesheet" href="./css/styles.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <a href="../index.php" class="logo">Tripma</a>
            <ul class="nav-links">
                <li><a href="search-flight.html">Flights</a></li>
                <li><a href="login.html">Sign in</a></li>
            </ul>
        </nav>
    </header>

    <!-- Flight Route Header -->
    <div style="background: var(--gray-light); padding: 1rem 2rem;">
        <div
            style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="font-weight: 600;">SFO California, US</span>
                <span style="color: var(--primary-purple);">‚Üí</span>
                <span style="font-weight: 600;">NRT Tokyo, Japan</span>
            </div>
            <div style="display: flex; gap: 2rem;">
                <div>
                    <p style="margin: 0; color: var(--gray-medium); font-size: 0.875rem;">Departing</p>
                    <p style="margin: 0; font-weight: 600;">Feb 25 | 7:00AM</p>
                </div>
                <div style="background: var(--purple-light); padding: 0.5rem 1rem; border-radius: 8px;">
                    <p style="margin: 0; color: var(--gray-medium); font-size: 0.875rem;">Arriving</p>
                    <p style="margin: 0; font-weight: 600;">Mar 21 | 12:15PM</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container" style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 2rem; margin-top: 2rem;">
        <!-- Left: Seat Map -->
        <div class="card">
            <h3 style="color: var(--primary-purple); margin-bottom: 1rem;">Select Your Seat</h3>
            <div id="seatMap"
                style="display: grid; gap: 0.5rem; padding: 1rem; background: var(--gray-light); border-radius: 8px; min-height: 500px;">
                <!-- Seat rows will be generated by JavaScript -->
            </div>
            <div style="margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <div style="width: 20px; height: 20px; background: #10B981; border-radius: 4px;"></div>
                    <span style="font-size: 0.875rem;">Available</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <div style="width: 20px; height: 20px; background: #6B7280; border-radius: 4px;"></div>
                    <span style="font-size: 0.875rem;">Occupied</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <div
                        style="width: 20px; height: 20px; background: #DC2626; border-radius: 4px; border: 2px solid white;">
                    </div>
                    <span style="font-size: 0.875rem;">Selected</span>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <div style="width: 20px; height: 20px; background: #1E40AF; border-radius: 4px;"></div>
                    <span style="font-size: 0.875rem;">Exit Row</span>
                </div>
            </div>
        </div>

        <!-- Right: Flight Details & Class Options -->
        <div>
            <!-- Class Selection -->
            <div class="card" style="margin-bottom: 1.5rem;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                    <!-- Economy -->
                    <div id="economyClass"
                        style="border: 2px solid var(--primary-purple); border-radius: 12px; padding: 1.5rem; cursor: pointer;"
                        onclick="selectClass('economy')">
                        <div style="text-align: center; margin-bottom: 1rem;">
                            <div style="font-size: 3rem;">üí∫üí∫üí∫</div>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="color: var(--primary-purple); margin: 0;">Economy</h3>
                            <span id="economyBadge" class="badge badge-info">Selected</span>
                        </div>
                        <p style="color: var(--gray-medium); margin-bottom: 1rem; font-size: 0.875rem;">
                            Rest and recharge during your flight with extended leg room, personalized service, and a
                            multi-course meal service.
                        </p>
                        <ul style="list-style: none; padding: 0; margin: 0;">
                            <li style="margin-bottom: 0.5rem; color: var(--primary-purple);">‚Ä¢ Built-in entertainment
                                system</li>
                            <li style="margin-bottom: 0.5rem; color: var(--primary-purple);">‚Ä¢ Complimentary snacks and
                                drinks</li>
                            <li style="margin-bottom: 0.5rem; color: var(--primary-purple);">‚Ä¢ One free carry-on and
                                personal item</li>
                        </ul>
                    </div>

                    <!-- Business Class -->
                    <div id="businessClass"
                        style="border: 2px solid var(--gray-light); border-radius: 12px; padding: 1.5rem; cursor: pointer;"
                        onclick="selectClass('business')">
                        <div style="text-align: center; margin-bottom: 1rem;">
                            <div style="font-size: 3rem;">üõãÔ∏èüõãÔ∏è</div>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="color: var(--gray-dark); margin: 0;">Business class</h3>
                            <span id="businessBadge" style="display: none;" class="badge badge-info">Selected</span>
                        </div>
                        <p style="color: var(--gray-medium); margin-bottom: 1rem; font-size: 0.875rem;">
                            Rest and recharge during your flight with extended leg room, personalized service, and a
                            multi-course meal service.
                        </p>
                        <ul style="list-style: none; padding: 0; margin: 0;">
                            <li style="margin-bottom: 0.5rem; color: #10B981;">‚úì Extended leg room</li>
                            <li style="margin-bottom: 0.5rem; color: #10B981;">‚úì First two checked bags free</li>
                            <li style="margin-bottom: 0.5rem; color: #10B981;">‚úì Priority boarding</li>
                            <li style="margin-bottom: 0.5rem; color: #10B981;">‚úì Personalized service</li>
                            <li style="margin-bottom: 0.5rem; color: #10B981;">‚úì Enhanced food and drink service</li>
                            <li style="margin-bottom: 0.5rem; color: #10B981;">‚úì Seats that recline 40% more than
                                economy</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Passenger Info & Actions -->
            <div class="card" style="position: sticky; bottom: 0;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <div>
                        <p style="margin: 0; color: var(--gray-medium); font-size: 0.875rem;">Passenger 1</p>
                        <p style="margin: 0; font-weight: 600; font-size: 1.125rem;">Sofia Knowles</p>
                    </div>
                    <div style="text-align: center;">
                        <p style="margin: 0; color: var(--gray-medium); font-size: 0.875rem;">Seat number</p>
                        <p id="selectedSeat"
                            style="margin: 0; font-weight: 600; font-size: 1.125rem; color: var(--primary-purple);">--
                        </p>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="saveAndClose()" class="btn btn-secondary" style="flex: 1;">Save and close</button>
                    <button onclick="goToPayment()" class="btn btn-primary" style="flex: 1;">Payment method</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upgrade Modal -->
    <div id="upgradeModal" class="modal">
        <div class="modal-content">
            <h2 style="color: var(--primary-purple); margin-bottom: 1rem;">Upgrade seat</h2>
            <p style="color: var(--gray-medium); margin-bottom: 1.5rem;">
                Upgrade your seat for only $199, and enjoy 45 percent more leg room, and seats that recline 40 percent
                more than economy.
            </p>
            <div style="display: flex; gap: 1rem;">
                <button onclick="closeUpgradeModal()" class="btn btn-secondary" style="flex: 1;">Cancel</button>
                <button onclick="confirmUpgrade()" class="btn btn-primary" style="flex: 1;">Upgrade for $199</button>
            </div>
        </div>
    </div>

    <script>
        let selectedSeat = null;
        let selectedClass = 'economy';
        let seatUpgradePrice = 0;

        // Generate seat map
        function generateSeatMap() {
            const seatMap = document.getElementById('seatMap');
            const rows = 24;
            const seatsPerRow = ['A', 'B', 'C', 'D', 'E', 'F'];

            seatMap.innerHTML = '';

            for (let row = 1; row <= rows; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.style.display = 'flex';
                rowDiv.style.alignItems = 'center';
                rowDiv.style.gap = '0.5rem';
                rowDiv.style.marginBottom = '0.5rem';

                // Row number
                const rowLabel = document.createElement('div');
                rowLabel.style.width = '30px';
                rowLabel.style.textAlign = 'center';
                rowLabel.style.fontWeight = '600';
                rowLabel.textContent = row;
                rowDiv.appendChild(rowLabel);

                // Seats
                seatsPerRow.forEach((seat, index) => {
                    const seatDiv = document.createElement('div');
                    const seatId = `${row}${seat}`;

                    // Determine seat status
                    let status = 'available';
                    let bgColor = '#10B981';

                    // Randomly set some seats as occupied
                    if (Math.random() > 0.6) {
                        status = 'occupied';
                        bgColor = '#6B7280';
                    }

                    // Exit rows (6-7, 13-14, 18-19)
                    if ((row >= 6 && row <= 7) || (row >= 13 && row <= 14) || (row >= 18 && row <= 19)) {
                        if (status === 'available') {
                            bgColor = '#1E40AF';
                        }
                    }

                    seatDiv.style.width = '35px';
                    seatDiv.style.height = '35px';
                    seatDiv.style.background = bgColor;
                    seatDiv.style.borderRadius = '6px';
                    seatDiv.style.cursor = status === 'available' ? 'pointer' : 'not-allowed';
                    seatDiv.style.display = 'flex';
                    seatDiv.style.alignItems = 'center';
                    seatDiv.style.justifyContent = 'center';
                    seatDiv.style.color = 'white';
                    seatDiv.style.fontSize = '0.75rem';
                    seatDiv.style.fontWeight = '600';
                    seatDiv.textContent = seat;
                    seatDiv.dataset.seatId = seatId;
                    seatDiv.dataset.status = status;

                    if (status === 'available') {
                        seatDiv.onclick = () => selectSeat(seatId, seatDiv);
                    }

                    rowDiv.appendChild(seatDiv);

                    // Add aisle
                    if (index === 2) {
                        const aisle = document.createElement('div');
                        aisle.style.width = '20px';
                        rowDiv.appendChild(aisle);
                    }
                });

                seatMap.appendChild(rowDiv);

                // Add exit row label
                if (row === 5 || row === 12 || row === 17) {
                    const exitLabel = document.createElement('div');
                    exitLabel.style.display = 'flex';
                    exitLabel.style.alignItems = 'center';
                    exitLabel.style.gap = '0.5rem';
                    exitLabel.style.marginTop = '0.5rem';
                    exitLabel.style.marginBottom = '0.5rem';
                    exitLabel.style.paddingLeft = '40px';
                    exitLabel.innerHTML = '<span style="font-size: 0.875rem; color: var(--gray-medium);">‚ÑπÔ∏è Exit row</span>';
                    seatMap.appendChild(exitLabel);
                }
            }
        }

        function selectSeat(seatId, seatElement) {
            // Deselect previous seat
            if (selectedSeat) {
                const prevSeat = document.querySelector(`[data-seat-id="${selectedSeat}"]`);
                if (prevSeat && prevSeat.dataset.status === 'available') {
                    const row = parseInt(selectedSeat.match(/\d+/)[0]);
                    if ((row >= 6 && row <= 7) || (row >= 13 && row <= 14) || (row >= 18 && row <= 19)) {
                        prevSeat.style.background = '#1E40AF';
                    } else {
                        prevSeat.style.background = '#10B981';
                    }
                    prevSeat.textContent = selectedSeat.slice(-1);
                }
            }

            // Select new seat
            selectedSeat = seatId;
            seatElement.style.background = '#DC2626';
            seatElement.innerHTML = '‚úì';
            document.getElementById('selectedSeat').textContent = seatId;

            // Check if it's an exit row and offer upgrade
            const row = parseInt(seatId.match(/\d+/)[0]);
            if ((row >= 6 && row <= 7) || (row >= 13 && row <= 14) || (row >= 18 && row <= 19)) {
                if (selectedClass === 'economy') {
                    setTimeout(() => openUpgradeModal(), 500);
                }
            }
        }

        function selectClass(className) {
            selectedClass = className;

            const economyDiv = document.getElementById('economyClass');
            const businessDiv = document.getElementById('businessClass');
            const economyBadge = document.getElementById('economyBadge');
            const businessBadge = document.getElementById('businessBadge');

            if (className === 'economy') {
                economyDiv.style.border = '2px solid var(--primary-purple)';
                businessDiv.style.border = '2px solid var(--gray-light)';
                economyBadge.style.display = 'inline-block';
                businessBadge.style.display = 'none';
            } else {
                economyDiv.style.border = '2px solid var(--gray-light)';
                businessDiv.style.border = '2px solid var(--primary-purple)';
                economyBadge.style.display = 'none';
                businessBadge.style.display = 'inline-block';
                openUpgradeModal();
            }
        }

        function openUpgradeModal() {
            document.getElementById('upgradeModal').classList.add('active');
        }

        function closeUpgradeModal() {
            document.getElementById('upgradeModal').classList.remove('active');
        }

        function confirmUpgrade() {
            seatUpgradePrice = 199;
            selectedClass = 'business';
            selectClass('business');
            closeUpgradeModal();
            alert('Seat upgraded to Business Class! Additional $199 will be added to your total.');
        }

        function saveAndClose() {
            if (!selectedSeat) {
                alert('Please select a seat first.');
                return;
            }
            alert('Seat saved!');
            // In real app, save to backend
        }

        function goToPayment() {
            if (!selectedSeat) {
                alert('Please select a seat first.');
                return;
            }
            // Pass seat and upgrade info to payment page
            const params = new URLSearchParams({
                seat: selectedSeat,
                class: selectedClass,
                upgrade: seatUpgradePrice
            });
            window.location.href = `payment.html?${params.toString()}`;
        }

        function saveAndClose() {
            if (!selectedSeat) {
                alert('Please select a seat first.');
                return;
            }
            // Save seat selection and go back
            window.location.href = 'passenger-information.html';
        }

        // Initialize seat map on load
        generateSeatMap();
    </script>
</body>

</html>